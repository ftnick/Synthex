<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List</title>
</head>
<body>

    <h1>Todo List</h1>

    <ul id="todo-list">
        <!-- Todo items will be dynamically added here -->
    </ul>

    <form id="add-todo-form">
        <label for="new-todo">Add New Todo:</label>
        <input type="text" id="new-todo" name="new-todo" required>
        <button type="button" onclick="addTodo()">Add</button>
    </form>

    <p>View and update the todo list file on GitHub: <a href="https://github.com/ftnick/Synthex-Roblox/blob/main/todo.txt" target="_blank">todo.txt</a></p>

    <script>
        function addTodo() {
            // Get the new todo text
            var newTodoText = document.getElementById('new-todo').value;

            // Create a new list item
            var listItem = document.createElement('li');
            listItem.textContent = newTodoText;

            // Append the new item to the todo list
            document.getElementById('todo-list').appendChild(listItem);

            // Clear the input field
            document.getElementById('new-todo').value = '';

            // Update the todo.txt file on GitHub using the GitHub API
            updateGitHubFile(newTodoText);
        }

        async function updateGitHubFile(newTodoText) {
            // GitHub API details
            const username = 'ftnick';
            const repo = 'Synthex-Roblox';
            const filePath = 'todo.txt';
            const branch = 'main';
            const accessToken = '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';

            // Fetch current content of the file
            const currentContentResponse = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${filePath}?ref=${branch}`);
            const currentContent = await currentContentResponse.json();

            // Update content
            const updatedContent = btoa(currentContent.content + '\n' + newTodoText);

            // Make a PUT request to update the file
            const updateResponse = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/${filePath}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: 'Update todo.txt',
                    content: updatedContent,
                    sha: currentContent.sha,
                    branch: branch,
                }),
            });

            if (updateResponse.ok) {
                alert('Todo updated successfully on GitHub!');
            } else {
                const errorResponse = await updateResponse.json();
                alert(`Failed to update todo.txt on GitHub. Error: ${errorResponse.message}`);
            }
        }
    </script>

</body>
</html>
